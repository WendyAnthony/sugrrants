<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Rearrange a temporal data frame to a calendar-based data format using
linear algebra — frame_calendar • sugrrants</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">sugrrants</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/frame-calendar.html">Calendar based graphics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Rearrange a temporal data frame to a calendar-based data format using
linear algebra</h1>
    </div>

    
    <p>Temporal data of daily intervals or higher frequency levels can
be organised into a calendar-based format, which is useful for visually
presenting calendar-related activities or multiple seasonality (such as
time of day, day of week, day of month). The function only returns a
rearranged data frame, and <code>ggplot2</code> takes care of the plotting afterwards.
It allows more flexibility for users to visualise the data in various ways.</p>
    

    <pre class="usage"><span class='fu'>frame_calendar</span>(<span class='no'>data</span>, <span class='no'>x</span>, <span class='no'>y</span>, <span class='no'>date</span>, <span class='kw'>calendar</span> <span class='kw'>=</span> <span class='st'>"monthly"</span>, <span class='kw'>dir</span> <span class='kw'>=</span> <span class='st'>"h"</span>,
  <span class='kw'>sunday</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>polar</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>scale</span> <span class='kw'>=</span> <span class='st'>"fixed"</span>)

<span class='fu'>prettify</span>(<span class='no'>plot</span>, <span class='kw'>label</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"label"</span>, <span class='st'>"text"</span>), <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame or a grouped data frame including a <code>Date</code> variable.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A bare (or unquoted) variable mapping to x axis, for example time of
day. If integer 1 is specified, it simply returns calendar grids on x
without transformation.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A bare (or unquoted) variable or more mapping to y axis. More than
one variable need putting to <code><a href='http://dplyr.tidyverse.org/reference/vars.html'>vars()</a></code>. If integer 1 is specified, it returns
calendar grids on y without transformation.</p></td>
    </tr>
    <tr>
      <th>date</th>
      <td><p>A <code>Date</code> variable mapping to dates in the calendar.</p></td>
    </tr>
    <tr>
      <th>calendar</th>
      <td><p>Type of calendar. "monthly" calendar (the default) organises
the <code>data</code> to a common format comprised of day of week in the column and
week of month in the row. "weekly" calendar consists of day of week and
week of year. "daily" calendar refers to day of month and month of year.</p></td>
    </tr>
    <tr>
      <th>dir</th>
      <td><p>Direction of calendar: "h" for horizontal (the default) or "v" for
vertical.</p></td>
    </tr>
    <tr>
      <th>sunday</th>
      <td><p>FALSE (the default) indicating to starting with Monday in a
week, or TRUE for Sunday, when <code>calendar = "monthly"</code>.</p></td>
    </tr>
    <tr>
      <th>nrow, ncol</th>
      <td><p>Number of rows and columns defined for "monthly" calendar
layout. If <code>NULL</code>, it computes a sensible layout.</p></td>
    </tr>
    <tr>
      <th>polar</th>
      <td><p>FALSE (the default) for Cartesian or TRUE for polar coordinates.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>"fixed" (the default) for fixed scale. "free" for scaling
conditional on each daily cell, "free_wday" for scaling on weekdays,
"free_mday" for scaling on day of month.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>ggplot object</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>If "label" is specified, it will add month/week text on the
<code>ggplot</code> object, which is actually passed to <code>geom_label()</code>. If "text" is
specified, it will add weekday/day of month text on the <code>ggplot</code> object,
which is actually passed to <code>geom_text()</code>. By default, both "label" and
"text" are used.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Extra arguments passed to <code>geom_label()</code> and <code>geom_text()</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame or a tibble with newly added columns of <code>.x</code>, <code>.y</code>. <code>.x</code>
and <code>.y</code> together give new coordinates computed for different types of
calendars. <code>date</code> groups the same dates in a chronological order, which is
useful for <code>geom_line</code> or <code>geom_path</code>. The basic use is <code>ggplot(aes(x = .x, y = .y, group = date)) + geom_*</code>. The variable names <code>.x</code> and <code>.y</code> reflect
the actual <code>x</code> and <code>y</code> with a prefix <code>.</code>.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The calendar-based graphic can be considered as small multiples
of sub-series arranged into many daily cells. For every multiple (or
facet), it requires the <code>x</code> variable mapped to be time of day and <code>y</code> to
value. New <code>x</code> and <code>y</code> are computed and named with a <code>.</code> prefixed to variable
according to <code>x</code> and <code>y</code> respectively, and get ready for <code>ggplot2</code> aesthetic
mappings. In conjunction with <code><a href='http://dplyr.tidyverse.org/reference/group_by.html'>group_by()</a></code>, it allows the grouped variable
to have their individual scales. For more details, see <code><a href='https://cran.rstudio.com/web/packages/sugrrants/vignettes/frame-calendar.html'>vignette("frame-calendar", package = "sugrrants")</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>   <span class='fu'>library</span>(<span class='no'>dplyr</span>)
   <span class='co'># compute the calendar layout for the data frame</span>
   <span class='no'>calendar_df</span> <span class='kw'>&lt;-</span> <span class='no'>pedestrian</span> <span class='kw'>%&gt;%</span>
     <span class='fu'><a href='http://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>Sensor_ID</span> <span class='kw'>==</span> <span class='fl'>13</span>) <span class='kw'>%&gt;%</span>
     <span class='fu'>frame_calendar</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>Time</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>Hourly_Counts</span>, <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>Date</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>4</span>)

   <span class='co'># ggplot</span>
   <span class='no'>p1</span> <span class='kw'>&lt;-</span> <span class='no'>calendar_df</span> <span class='kw'>%&gt;%</span>
     <span class='fu'>ggplot</span>(<span class='fu'>aes</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>.Time</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>.Hourly_Counts</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>Date</span>)) +
     <span class='fu'>geom_line</span>()
   <span class='fu'>prettify</span>(<span class='no'>p1</span>)</div><div class='img'><img src='frame-calendar-3.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>
   <span class='co'># use in conjunction with group_by()</span>
   <span class='no'>grped_calendar</span> <span class='kw'>&lt;-</span> <span class='no'>pedestrian</span> <span class='kw'>%&gt;%</span>
     <span class='fu'><a href='http://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>Year</span> <span class='kw'>==</span> <span class='st'>"2017"</span>, <span class='no'>Month</span> <span class='kw'>==</span> <span class='st'>"March"</span>) <span class='kw'>%&gt;%</span>
     <span class='fu'><a href='http://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>Sensor_Name</span>) <span class='kw'>%&gt;%</span>
     <span class='fu'>frame_calendar</span>(
       <span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>Time</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>Hourly_Counts</span>, <span class='kw'>date</span> <span class='kw'>=</span> <span class='no'>Date</span>, <span class='kw'>sunday</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
     )

   <span class='no'>grped_calendar</span> <span class='kw'>%&gt;%</span>
     <span class='fu'>ggplot</span>(<span class='fu'>aes</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>.Time</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>.Hourly_Counts</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>Date</span>)) +
     <span class='fu'>geom_line</span>() +
     <span class='fu'>facet_wrap</span>(~ <span class='no'>Sensor_Name</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='img'><img src='frame-calendar-4.png' alt='' width='700' height='432.632880098887' /></div><div class='input'>   # prettify() not working for group_by

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Earo Wang

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='http://earo.me'>Earo Wang</a>, <a href='http://dicook.org'>Di Cook</a>, <a href='http://robjhyndman.com'>Rob Hyndman</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
